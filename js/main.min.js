"use strict";!function(t){function a(){var a=localStorage.length;if(a)for(var e=0;e<a;e++){var s=localStorage.key(e);if(0===s.indexOf(c)){var r=localStorage.getItem(s),o=JSON.parse(r);t("<div></div>").addClass("todo__task").addClass("task").attr("data-priority",o.item1).attr("data-order","0").attr("data-project",o.item2).attr("data-lsItem",s).prependTo(n),t("<h2></h2>").addClass("task__title").text(o.item4).appendTo(t(".task:eq(0)")),t("<div></div>").addClass("task__info").appendTo(t(".task:eq(0)")),t("<div></div>").addClass("task__project").text("Проект: ").appendTo(t(".task:eq(0) .task__info")),t("<span></span>").addClass("task__project-name").text(o.item2).appendTo(t(".task:eq(0) .task__project")),t("<div></div>").addClass("task__priority").text("priority: ").appendTo(t(".task:eq(0) .task__info")),t("<span></span>").addClass("task__priority-num").text(o.item1).appendTo(t(".task:eq(0) .task__priority")),t("<p></p>").addClass("task__description").text(o.item5).appendTo(t(".task:eq(0)")),t("<div></div>").addClass("task__btn-group").appendTo(t(".task:eq(0)")),t("<button></button>").addClass("btn").addClass("btn-primary").addClass("change-task").text("Изменить").attr("type","button").appendTo(t(".task:eq(0) .task__btn-group")),t("<button></button>").addClass("btn").addClass("btn-primary").addClass("remove-task").attr("type","button").text("Закрыть").appendTo(t(".task:eq(0) .task__btn-group")),t("<button></button>").addClass("btn").addClass("btn-primary").addClass("show-text-switch").attr("type","button").text("Свернуть").appendTo(t(".task:eq(0) .task__btn-group"))}}}function e(){var a=t("#taskName").val(),e=t("#projectName").val(),k=t("#priorityAdd").val(),u=t("#description").val(),_=t("#taskName"),v=t("#projectName"),m=t("#priorityAdd"),C=t("#description"),h=!0;switch(""){case a:_.parents(".input-group").addClass("error"),h=!1;case e:v.parents(".input-group").addClass("error"),h=!1;case k:m.parents(".input-group").addClass("error"),h=!1;case u:C.parents(".input-group").addClass("error"),h=!1;break;default:h=!0,_.parents(".input-group").removeClass("error"),v.parents(".input-group").removeClass("error"),m.parents(".input-group").removeClass("error"),C.parents(".input-group").removeClass("error")}if(a&&_.parents(".input-group").removeClass("error"),e&&v.parents(".input-group").removeClass("error"),k&&m.parents(".input-group").removeClass("error"),u&&C.parents(".input-group").removeClass("error"),!1!==h){r(),t("<div></div>").addClass("todo__task").addClass("task").attr("data-priority",k).attr("data-order","0").attr("data-project",e).attr("data-lsItem",c+(+l+1)).prependTo(n),t("<h2></h2>").addClass("task__title").text(a).appendTo(t(".task:eq(0)")),t("<div></div>").addClass("task__info").appendTo(t(".task:eq(0)")),t("<div></div>").addClass("task__project").text("Проект: ").appendTo(t(".task:eq(0) .task__info")),t("<span></span>").addClass("task__project-name").text(e).appendTo(t(".task:eq(0) .task__project")),t("<div></div>").addClass("task__priority").text("priority: ").appendTo(t(".task:eq(0) .task__info")),t("<span></span>").addClass("task__priority-num").text(k).appendTo(t(".task:eq(0) .task__priority")),t("<p></p>").addClass("task__description").text(u).appendTo(t(".task:eq(0)")),t("<div></div>").addClass("task__btn-group").appendTo(t(".task:eq(0)")),t("<button></button>").addClass("btn").addClass("btn-primary").addClass("change-task").text("Изменить").attr("type","button").appendTo(t(".task:eq(0) .task__btn-group")),t("<button></button>").addClass("btn").addClass("btn-primary").addClass("remove-task").attr("type","button").text("Закрыть").appendTo(t(".task:eq(0) .task__btn-group")),t("<button></button>").addClass("btn").addClass("btn-primary").addClass("show-text-switch").attr("type","button").text("Свернуть").appendTo(t(".task:eq(0) .task__btn-group")),s(),d(),o(i,p),n.find("task").each(function(a,e){var s=t(this).attr("data-lsItem").slice(3);s>l&&(l=s)}),l++;var g={item1:k,item2:e,item3:c+l,item4:a,item5:u},f=JSON.stringify(g);localStorage.setItem(c+l,f)}}function s(){var a={},e="<option>Все</option>";t(".task__project-name").each(function(e,s){a[t(s).text()]=1});for(var s in a)a.hasOwnProperty(s)&&(e+="<option>"+s+"</option>");t("#projectCheck").html(e)}function r(){t("#taskName").val(""),t("#projectName").val(""),t("#priorityAdd").val("1"),t("#description").val("")}function o(t,a){t.show(),a.hide()}function d(){t(".task").each(function(a){t(this).attr("data-order",a)})}var n=t(".todo__list"),i=t(".todo__control"),p=t(".todo__add"),l=1,c="ls_";a(),t(".task").length>0&&(l=t(".task:eq(0)").attr("data-lsitem").slice(3),d()),t(document).on("click",".show-text-switch",function(){var a=t(this).text();t(this).parents(".task").find(".task__description").slideToggle(200),a="Свернуть"===a?"Развернуть":"Свернуть",t(this).text(a)}),t(document).on("click",".remove-task",function(){var a=t(this).closest(".task").attr("data-order"),e=t(".todo__add").attr("data-change"),n=t(this).closest(".task").attr("data-lsitem");a===e&&(o(i,p),r()),t(this).closest(".task").remove();var l=t(".task");s(),"Все"===t("#projectCheck").val()&&l.show(),localStorage.removeItem(n),d()}),t(document).on("change","#priorityCheck",function(){var a=t(".task");this.checked?a.sort(function(t,a){return t.getAttribute("data-priority")>a.getAttribute("data-priority")}).appendTo(a.parent()):a.sort(function(t,a){return t.getAttribute("data-order")>a.getAttribute("data-order")}).appendTo(a.parent())}),t(document).on("change","#projectCheck",function(){var a=t(this).val(),e=t(".task");t(e).each(function(e){"Все"===a?t(this).show():t(this).attr("data-project")===a?t(this).show():t(this).hide()})}),t("#addTask").on("click",function(){o(p,i),o(t("#saveNewTask"),t("#changeThisTask"))}),t("#cancelAddTask").on("click",function(){o(i,p),r(),t(".input-group").removeClass("error")}),t("#saveNewTask").on("click",function(){e()}),t(document).on("click",".change-task",function(){o(p,i);var a=t(this).closest(".task").find(".task__title").text(),e=t(this).closest(".task").find(".task__project-name").text(),s=t(this).closest(".task").find(".task__priority-num").text(),r=t(this).closest(".task").find(".task__description").text(),d=t(this).closest(".task").attr("data-lsitem"),n=t(this).closest(".task").attr("data-order");t(".todo__add").attr("data-change",d),t(".todo__add").attr("data-count",n),t("#taskName").val(a),t("#projectName").val(e),t("#priorityAdd").val(s),t("#description").val(r),o(t("#changeThisTask"),t("#saveNewTask"))}),t("#changeThisTask").on("click",function(){var a=t(".todo__add").attr("data-change"),e=t(".todo__add").attr("data-count"),d=t("#taskName").val(),n=t("#projectName").val(),l=t("#priorityAdd").val(),c=t("#description").val(),k=t("#taskName"),u=t("#projectName"),_=t("#priorityAdd"),v=t("#description"),m=!0;switch(""){case d:k.parents(".input-group").addClass("error"),m=!1;case n:u.parents(".input-group").addClass("error"),m=!1;case l:_.parents(".input-group").addClass("error"),m=!1;case c:v.parents(".input-group").addClass("error"),m=!1;break;default:m=!0,k.parents(".input-group").removeClass("error"),u.parents(".input-group").removeClass("error"),_.parents(".input-group").removeClass("error"),v.parents(".input-group").removeClass("error")}if(d&&k.parents(".input-group").removeClass("error"),n&&u.parents(".input-group").removeClass("error"),l&&_.parents(".input-group").removeClass("error"),c&&v.parents(".input-group").removeClass("error"),!1!==m){t(".task:eq("+e+")").attr("data-priority",t("#priorityAdd").val()),t(".task:eq("+e+")").attr("data-project",t("#projectName").val()),t(".task:eq("+e+") .task__title").text(t("#taskName").val()),t(".task:eq("+e+") .task__project-name").text(t("#projectName").val()),t(".task:eq("+e+") .task__priority-num").text(t("#priorityAdd").val()),t(".task:eq("+e+") .task__description").text(t("#description").val()),s(),r(),o(i,p),console.log(a);var C={item1:l,item2:n,item3:a,item4:d,item5:c},h=JSON.stringify(C);localStorage.setItem(a,h)}}),s()}(jQuery);